/* 
   知乎旧版主题（Zhihu Classic Theme）
   目标：将新版知乎的视觉改造成旧版风格（蓝色导航、白底、列表样式）。
   说明：按“页面结构相关性”重新组织，并使用中文注释。
*/

/* ================================
   1. 全局基础
   ================================ */
body {
    /* 旧版为白色背景 */
    background-color: #fff !important;
}

/* ================================
   2. 顶部导航容器（旧版蓝色）
   ================================ */
.AppHeader {
    /* 旧版导航渐变、边框与阴影 */
    background: #086ed5 !important; /* 回退色 */
    background: linear-gradient(to bottom, #086ed5, #055db5) !important;
    border-bottom: 1px solid #044e97 !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, .25), inset 0 1px 0 rgba(255, 255, 255, .15) !important;
    /* 高度统一为 45px */
    height: 45px !important;
    min-height: 45px !important;
}

.AppHeader-inner {
    /* 旧版常用宽度（960/1000），这里选 960 */
    max-width: 960px !important;
    height: 45px !important;
    min-height: 45px !important;
}

/* 主内容与头部的间距微调（避免遮挡） */
.App-main {
    margin-top: -20px !important;
}

/* ================================
   3. 导航标签（居中、白字）
   ================================ */
.AppHeader-Tabs {
    height: 45px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important; 
    padding: 0 !important;
}

/* 导航链接统一白色、居中、垂直对齐 */
.AppHeader-Tabs a,
.AppHeader-Tabs .Tabs-link,
.TopstoryTabs-link,
.AppHeader-navItem {
    color: #fff !important;
    opacity: 0.7 !important;
    transition: opacity 0.2s, color 0.2s;
    line-height: 45px !important; 
    height: 45px !important;
    padding: 0 15px !important;
    font-size: 14px !important;
    text-align: center !important; 
    text-decoration: none !important;
    display: flex !important;
    align-items: center !important;
}

/* 悬停增强对比 */
.AppHeader-Tabs a:hover,
.AppHeader-Tabs .Tabs-link:hover {
    opacity: 1 !important;
    color: #fff !important;
}

/* 选中态加粗且不透明 */
.AppHeader-Tabs .Tabs-link.is-active,
.AppHeader-Tabs a.is-active {
    color: #fff !important; 
    font-weight: bold !important;
    opacity: 1 !important;
}

/* 选中下划线位置与高度 */
.AppHeader-Tabs .Tabs-link.is-active::after,
.AppHeader-Tabs a.is-active::after {
    background-color: #fff !important;
    height: 3px !important;
    bottom: 0 !important; 
}

/* ================================
   4. Logo（替换为指定图片）
   ================================ */
.AppHeader-logo,
a[aria-label="知乎"] {
    height: 45px !important;
    display: flex !important;
    align-items: center !important;
    /* 使用外链图片替换旧 Logo */
    background-image: url('./images/logo.png');
    background-repeat: no-repeat;
    background-position: center center;
    background-size: 64px auto;
    width: 80px !important; 
    margin-left: 10px;
    margin-right: 0 !important;
    /* 隐藏原始文本内容 */
    text-indent: -9999px !important; 
    overflow: hidden !important;
    color: transparent !important;
}

/* 隐藏原始 SVG Logo（防止覆盖失败） */
.AppHeader-logo svg,
a[aria-label="知乎"] svg {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
}

/* ================================
   5. 搜索框（尺寸与对齐）
   ================================ */
.SearchBar {
    margin-top: 0 !important;
    height: 32px !important; /* 紧凑高度 */
    background-color: rgba(0, 0, 0, 0.12) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 3px !important;
}

.SearchBar-tool {
    height: 32px !important;
    padding: 0 10px !important;
}

/* 输入框与占位符颜色（白色系） */
.SearchBar-inputInputWrapper .Input {
    color: #fff !important;
    height: 30px !important;
}
.SearchBar-inputInputWrapper .Input::placeholder {
    color: rgba(255, 255, 255, 0.5) !important;
}

/* 搜索按钮与图标 */
.SearchBar-searchButton {
    color: rgba(255, 255, 255, 0.8) !important;
    padding: 0 !important;
    height: 32px !important;
    width: 32px !important;
}
.SearchBar-searchButton svg {
    fill: rgba(255, 255, 255, 0.8) !important;
}

/* ================================
   6. 导航右侧（按钮与头像）
   ================================ */
.AppHeader-userInfo {
    height: 45px !important;
    display: flex !important;
    align-items: center !important;
}

/* 文本按钮颜色（白色系） */
.AppHeader-userInfo .Button--plain {
    color: rgba(255, 255, 255, 0.7) !important;
}
.AppHeader-userInfo .Button--plain:hover {
    color: #fff !important;
}

/* 提问按钮（旧版风格） */
.SearchBar-askButton {
    height: 32px !important;
    line-height: 30px !important; /* 文本垂直居中 */
    padding: 0 14px !important;
    background-color: #0077d9 !important; /* 略深蓝 */
    border: 1px solid rgba(0,0,0,0.1) !important;
    color: #fff !important;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.1) !important;
}
/* 按钮样式 */
.Button--blue, .QuestionHeader-side .Button--blue {
    color: #8ab923 !important;
    border: 1px solid #6d8f29 !important;
    border-radius: 4px !important;
}
.Button--primary {
    width: auto !important;
    min-width: 78px !important;
    color: #3e5e00 !important;
    text-shadow: 0 1px 0 rgba(255, 255, 255, .3) !important;
    background: #8ab923 !important;
    background: -webkit-linear-gradient(top, #adda4d, #86b846) !important;
    background: linear-gradient(to bottom, #adda4d, #86b846) !important;
    border: 1px solid #6d8f29 !important;
    border-radius: 4px !important;
    box-shadow: 0 1px 0 rgba(255, 255, 255, .5) inset, 0 1px 0 rgba(0, 0, 0, .2) !important;
}
.Button--primary:hover, .Button--primary:active, .Button--primary:focus {
    background: #79a814 !important;
    background: -webkit-linear-gradient(top, #9ac244, #78a53e) !important;
    background: linear-gradient(to bottom, #9ac244, #78a53e) !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, .3) inset !important;
    border-radius: 4px !important;
}
.Button--secondary {
    color: #3e5e00 !important;
    background: #d4e1b7 !important;
    border-radius: 4px !important;
}
.QuestionButtonGroup .Button {
    color: #3e5e00 !important;
}

/* 头像边框（收敛圆角） */
.AppHeader-profile .Avatar {
    width: 30px !important;
    height: 30px !important;
    border: 1px solid rgba(255,255,255,0.3) !important;
}

/* ================================
   7. 内容列表（去卡片化）
   ================================ */

/* 文章标题 */
.ColumnPageHeader {
    background-color: transparent !important;
    background: transparent !important;
    height: 45px !important;
}
.ColumnPageHeader-Title, .ColumnPageHeader-content {
    height: 45px !important;
    line-height: 45px !important;
    background-color: transparent !important;
    background: transparent !important;
    color: #fff !important;
}
.ColumnPageHeader-Title div, .ColumnPageHeader-content div {
    color: #fff !important;
}

/* 去阴影、去边框、去圆角，呈现列表分段 */
.Card, 
.TopstoryItem,
.AnswerItem,
.ArticleItem,
.HotItem {
    background: transparent !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    border: none !important;
    margin-bottom: 0 !important;
    padding: 16px 0 !important;
    border-bottom: none !important; 
}

/* 标题：经典知乎蓝 */
.AppHeader .QuestionHeader-title {
    color: #fff !important;
}
.AppHeader .QuestionHeader-main {
    padding-left: 0 !important;
}
.ContentItem-title {
    margin-bottom: 6px !important;
    font-size: 18px !important;
}

.ContentItem-title a,
.HotItem-title {
    color: #175199 !important; /* 旧版链接蓝 */
    font-weight: bold !important;
    text-decoration: none !important;
}

.ContentItem-title a:hover {
    text-decoration: underline !important;
}

/* 正文文字：更深的黑灰 */
.RichContent-inner, 
.ContentItem-excerpt,
.HotItem-excerpt {
    color: #222 !important;
    font-size: 14px !important;
    line-height: 1.6 !important;
}

/* 操作区间距 */
.ContentItem-actions {
    margin-top: 10px !important;
}

/* ================================
   8. 侧栏（简化视觉）
   ================================ */
.GlobalSideBar .Card {
    box-shadow: none !important;
    border: 1px solid #eee !important; /* 轻描边 */
    background: #fff !important;       /* 白底 */
    margin-bottom: 10px !important;
}

/* ================================
   9. 投票按钮（淡蓝）
   ================================ */
.VoteButton {
    background: #eff6fa !important;
    color: #0084ff !important;
    border-color: transparent !important;
}
.VoteButton.is-active {
    background: #0084ff !important;
    color: #fff !important;
}

/* ================================
   10. 隐藏广告容器
   ================================ */
.Pc-feedAd-container,
.TopstoryItem--advertCard {
    display: none !important;
}

/* ================================
   11. 兜底兼容（针对动态类名）
   说明：知乎使用 CSS-in-JS，类名经常是随机的，以下规则用于强制标题白色与高度。
   ================================ */
.css-lgijre { /* 顶部容器未知类名：强制高度 */
    height: 45px !important;
}
.css-lgijre > div nav a,
.css-lgijre > div a {
    /* 导航链接统一白色与字号 */
    color: #fff !important;
    font-size: 14px !important;
}
.css-lgijre > div nav a:hover,
.css-lgijre > div a:hover {
    color: #fff !important;
}
.css-lgijre > div nav a.is-active > div > div {
    /* 选中下划线为白色 */
    background-color: #fff !important;
}
.Avatar {
    /* 头像圆角更小，更贴旧版 */
    border-radius: 2px !important;
}
.Popover .css-vurnku, .Popover > button:not([aria-label="更多"]) {
    color: #fff !important;
    font-size: 12px !important;
    border-radius: 4px !important;
}
.Popover .css-vurnku:hover {
    color: #fff !important;
    font-size: 12px !important;
}
.Popover > button:not([aria-label="更多"]):hover {
    color: #fff !important;
    font-size: 12px !important;
    font-weight: bold !important;  
}
.css-vurnku {
    font-size: 12px !important;
}
.css-vurnku:hover {
    font-size: 12px !important;
    font-weight: bold !important;  
}
.Popover .SearchBar-input {
    max-width: inherit !important;
    border-radius: 4px !important;
    font-size: 14px !important;
}
.SearchBar-searchButton, .css-v0eidh .SearchBar-searchButton {
    border-bottom-right-radius: 4px !important;
    border-top-right-radius: 4px !important;
    font-size: 14px !important;
}
@supports (color:lab(from red l 1 1%/calc(alpha + 0.1))) {
    .Topstory-mainColumnCard {
        /* 某些环境的卡片阴影清除（兜底） */
        -webkit-box-shadow: none !important;
        box-shadow: none !important;
        font-size: 14px !important;
    }
}
.QuestionHeader-side .Button--blue {
    color: #fff !important;
}

/* ================================
   12. 暗黑模式适配 (Dark Mode)
   说明：当操作系统切换为深色模式时生效
   ================================ */
@media (prefers-color-scheme: dark) {
    /* 1. 全局背景与文字 */
    body {
        background-color: #121212 !important;
        color: #c5c5c5 !important;
    }

    /* 2. 侧栏卡片：深灰底、深边框 */
    .GlobalSideBar .Card {
        background-color: #1e1e1e !important;
        border-color: #333 !important;
        color: #c5c5c5 !important;
    }

    /* 3. 内容标题：由深蓝改为浅蓝，确保黑底可读 */
    .ContentItem-title a,
    .HotItem-title {
        color: #64b5f6 !important;
    }
    
    /* 4. 内容摘要：灰白 */
    .RichContent-inner, 
    .ContentItem-excerpt,
    .HotItem-excerpt {
        color: #b0b0b0 !important;
    }

    /* 5. 投票按钮：半透明蓝底，浅蓝字 */
    .VoteButton {
        background: rgba(0, 132, 255, 0.15) !important;
        color: #64b5f6 !important;
    }
    .VoteButton:hover {
        background: rgba(0, 132, 255, 0.25) !important;
    }
    /* 选中状态保持原样 (蓝底白字) */

    /* 6. 操作按钮 (评论、分享等)：浅灰 */
    .ContentItem-actions .Button--plain, 
    .ContentItem-action {
        color: #8590a6 !important;
    }
    .ContentItem-actions .Button--plain:hover, 
    .ContentItem-action:hover {
        color: #bbb !important;
    }

    /* 7. 输入框与评论区 */
    .Input, 
    .Editable, 
    .Comments-container,
    .CommentListV2-headerDivider,
    .Topbar {
        background-color: #1e1e1e !important;
        border-color: #333 !important;
        color: #eee !important;
    }
    
    /* 8. 搜索下拉/菜单/气泡 */
    .Popover-content, 
    .Menu {
        background-color: #1e1e1e !important;
        border-color: #333 !important;
    }
    .Menu-item {
        color: #eee !important;
    }
    .Menu-item:hover {
        background-color: #333 !important;
    }

    /* 9. 杂项覆盖 */
    /* 覆盖知乎自带的白色背景强制 */
    .WhiteScreen {
        background: #121212 !important;
    }
    
    /* 问题头部背景 */
    .QuestionHeader {
        background: #1e1e1e !important;
    }
    .QuestionHeader-title {
        color: #eee !important;
    }
    .QuestionHeader-footer {
        background: #1e1e1e !important;
    }
    
    /* 顶栏保持蓝色，但微调阴影使其融合 */
    .AppHeader {
        box-shadow: 0 1px 2px rgba(0, 0, 0, .5) !important;
    }

    /* 顶栏搜索框与输入 */
    .SearchBar {
        background-color: rgba(255, 255, 255, 0.15) !important;
        border-color: rgba(255, 255, 255, 0.2) !important;
    }
    .SearchBar-searchButton {
        color: rgba(255, 255, 255, 0.9) !important;
    }
    .SearchBar-searchButton svg {
        fill: rgba(255, 255, 255, 0.9) !important;
    }
    .SearchBar-inputInputWrapper .Input {
        color: #fff !important;
    }
    .SearchBar-inputInputWrapper .Input::placeholder {
        color: rgba(255, 255, 255, 0.6) !important;
    }

    /* 列表分隔线（暗色轻描） */
    .Card, 
    .TopstoryItem,
    .AnswerItem,
    .ArticleItem,
    .HotItem {
        border-bottom: 1px solid #222 !important;
    }

    /* 正文链接色 */
    .RichContent-inner a {
        color: #64b5f6 !important;
    }
    .RichContent-inner a:hover {
        color: #90caf9 !important;
    }

    /* 弹出搜索输入与菜单统一暗底 */
    .Popover .SearchBar-input {
        background-color: rgba(255, 255, 255, 0.12) !important;
        color: #fff !important;
    }

    /* 顶栏右侧主按钮边框微亮 */
    .AppHeader-userInfo .Button--primary {
        border-color: rgba(255, 255, 255, 0.2) !important;
    }
}
